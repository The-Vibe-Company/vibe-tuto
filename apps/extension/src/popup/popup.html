<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CapTuto</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">
    <header class="header">
      <h1 class="logo">CapTuto</h1>
      <p id="user-email" class="user-email hidden"></p>
    </header>

    <main class="main">
      <div id="not-connected" class="state">
        <div class="state-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
        </div>
        <p class="message">Connectez-vous pour commencer</p>
        <button id="login-btn" class="btn btn-primary">Se connecter</button>
      </div>

      <div id="idle" class="state hidden">
        <div class="state-icon idle-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <polygon points="10 8 16 12 10 16 10 8" fill="currentColor"></polygon>
          </svg>
        </div>
        <p class="message">Prêt à enregistrer votre tutoriel</p>
        <button id="start-btn" class="btn btn-primary btn-record">
          <span class="record-dot"></span>
          Démarrer l'enregistrement
        </button>
      </div>

      <div id="recording" class="state hidden">
        <div class="recording-status">
          <div class="recording-indicator">
            <span class="pulse"></span>
            <span>Enregistrement</span>
          </div>
          <div id="timer" class="timer">00:00</div>
        </div>
        <p class="message recording-message">Cliquez sur les éléments à capturer</p>
        <button id="stop-btn" class="btn btn-danger">
          <span class="stop-icon"></span>
          Arrêter l'enregistrement
        </button>
      </div>

      <div id="uploading" class="state hidden">
        <div class="state-icon">
          <div class="spinner"></div>
        </div>
        <p class="message">Envoi en cours...</p>
      </div>

      <div id="success" class="state hidden">
        <div class="state-icon success-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
            <polyline points="22 4 12 14.01 9 11.01"></polyline>
          </svg>
        </div>
        <p class="message">Tutoriel créé avec succès !</p>
        <a id="editor-link" href="#" class="btn btn-primary">Voir le tutoriel</a>
        <button id="new-recording-btn" class="btn btn-secondary">Nouvel enregistrement</button>
      </div>

      <div id="error" class="state hidden">
        <div class="state-icon error-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="15" y1="9" x2="9" y2="15"></line>
            <line x1="9" y1="9" x2="15" y2="15"></line>
          </svg>
        </div>
        <p id="error-message" class="message error-message">Une erreur est survenue</p>
        <button id="retry-btn" class="btn btn-primary">Réessayer</button>
      </div>
    </main>

    <footer class="footer">
      <a href="#" id="dashboard-link" class="link">Ouvrir le dashboard</a>
      <div class="settings-toggle">
        <button id="settings-btn" class="btn-icon" title="Paramètres">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
          </svg>
        </button>
      </div>
    </footer>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Paramètres</h3>
          <button id="close-settings" class="btn-close">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="api-url">URL de l'API</label>
            <input type="text" id="api-url-input" placeholder="http://localhost:3000" />
            <small class="help-text">Ex: http://localhost:3000 (local) ou https://captuto.com (prod)</small>
          </div>
        </div>
        <div class="modal-footer">
          <button id="save-settings" class="btn btn-primary btn-sm">Sauvegarder</button>
          <button id="reset-settings" class="btn btn-secondary btn-sm">Réinitialiser</button>
        </div>
      </div>
    </div>
  </div>

  <script src="popup.js" type="module"></script>
</body>
</html>
